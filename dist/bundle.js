/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
/******/ (() => { // webpackBootstrap
/*!**************************!*\
  !*** ./public/js/app.js ***!
  \**************************/
eval("const cityElement = document.querySelector(\".city span\");\r\nconst indexElement = document.querySelector(\".indexAir span\");\r\nconst index = document.querySelector(\".indexAir\");\r\nconst date = document.querySelector(\".day span\")\r\n\r\n// API KEY\r\nconst air_key = \"f018576ab29faf2b8f5b5d38a87dd05c65918720\";\r\n\r\nconst air = {};\r\n\r\n\r\n// CHECK IF BROWSER SUPPORTS GEOLOCATION\r\nif('geolocation' in navigator){\r\n    navigator.geolocation.getCurrentPosition(setPosition, showError);\r\n}else{\r\n    alert(\"Your browser doesn't support geolocation\");\r\n}\r\n\r\n// SET USER'S POSITION\r\nfunction setPosition(position){\r\n    let latitude = position.coords.latitude;\r\n    let longitude = position.coords.longitude;\r\n    getData(latitude, longitude);\r\n    \r\n}\r\n    \r\n\r\n// SHOW ERROR WHEN THERE IS AN ISSUE WITH GEOLOCATION SERVICE\r\nfunction showError(error){\r\n    alert(error.message);\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nfunction getLocation(){\r\n      \r\n    if (navigator.geolocation) {\r\n        navigator.geolocation.getCurrentPosition(function(position) {\r\n         latitude = position.coords.latitude;\r\n         longitude = position.coords.longitude;\r\n         \r\n        getData(latitude,longitude);\r\n        \r\n         \r\n      });\r\n   } else {\r\n        alert(\"Geolocation is not supported by this browser.\");\r\n      }\r\n  }\r\n    \r\n    \r\n// GET AIR POLLUTION FROM COORDINATES\r\n\r\nfunction getData(latitude,longitude){\r\n\r\n    let api = `https://api.waqi.info/feed/geo:${latitude};${longitude}/?token=${air_key}`;\r\n\r\n     fetch(api)\r\n        .then(function(response){\r\n            let data = response.json();\r\n            return data;\r\n        })\r\n        .then(function(data){\r\n            air.index = data.data.aqi;\r\n            air.city = data.data.city.name;\r\n            air.time = data.data.time.s;\r\n             \r\n        })\r\n        .then(function(){\r\n            let pollution = air.index;\r\n            showData();\r\n            changeBackground(pollution);\r\n        })\r\n}\r\n\r\n// DISPLAY INFORMATIONS\r\n\r\nfunction showData(){\r\n    cityElement.innerHTML = `${air.city}<span> </span>`;\r\n    indexElement.innerHTML = `${air.index}<span> </span>`;\r\n    date.innerHTML = `${air.time}<span> </span>`;\r\n    \r\n}\r\n\r\n\r\n//GET AIR POLLUTION FROM SEARCH  BAR\r\n\r\n btn_search.onclick = function() {\r\n    let city = document.getElementById('city').value;\r\n\r\n    let api = `https://api.waqi.info/search/?token=${air_key}&keyword=${city}`;\r\n\r\n     fetch(api)\r\n    .then(function(response){\r\n        let data = response.json();\r\n        return data;\r\n    })\r\n    .then(function(data){\r\n        air.city = data.data[0].station.name;\r\n        air.index = data.data[0].aqi;\r\n        air.time = data.data[0].time.stime;\r\n        \r\n    })\r\n    .then(function(){\r\n        let elemCity = air.city;\r\n        let pollution = air.index;\r\n        showData();\r\n        changeBackground(pollution);\r\n    })\r\n    .catch(error  => {\r\n        alert(\"Non è stata trovata nessuna località.\\nSi prega di inserire un'altra città.\");\r\n    })\r\n        \r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n// CHANGE BACKGROUND INDEX AIR\r\n\r\nfunction changeBackground(pollution){\r\n    if(pollution<=50){\r\n        index.style.background = \"rgb(58, 194, 58)\";\r\n        index.style.border = \" rgb(58, 194, 58)\";\r\n    }else if(pollution>=51 && pollution <=100) {\r\n        index.style.background = \"rgb(242, 245, 54)\";\r\n        index.style.border = \" rgb(242, 245, 54)\";\r\n    }else if(pollution>=101 && pollution <=150) {\r\n        index.style.background = \"rgb(243, 156, 57)\";\r\n        index.style.border = \" rgb(243, 156, 57)\";\r\n    }else if(pollution>=151 && pollution <=200) {\r\n        index.style.background = \"rgb(245, 22, 22)\";\r\n        index.style.border = \" rgb(245, 22, 22)\";\r\n    }else if(pollution>=201 && pollution <=300) {\r\n        index.style.background = \" rgb(136, 69, 245)\";\r\n        index.style.border = \" rgb(136, 69, 245)\";\r\n    }else if(pollution>300) {\r\n        index.style.background = \"rgb(160, 59, 59)\";\r\n        index.style.border = \" rgb(160, 59, 59)\";\r\n    }else {\r\n        index.style.background = \"lightgrey\";\r\n        index.style.border = \" lightgrey\";\r\n    }\r\n}\r\n    \r\n\n\n//# sourceURL=webpack://air-pollution/./public/js/app.js?");
/******/ })()
;